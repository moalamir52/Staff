# خدمة الإيميل التلقائية - Staff Monitoring System

## كيفية تشغيل الخدمة

### الطريقة الأولى: استخدام Command Prompt
```bash
cd d:\project\Staff
node automation-service.js
```

### الطريقة الثانية: استخدام npm script
```bash
cd d:\project\Staff
npm run email-service
```

### الطريقة الثالثة: استخدام ملف Batch (الأسهل)
- انقر مرتين على ملف `start-email-service.bat`

### الطريقة الرابعة: استخدام PowerShell
- انقر بالزر الأيمن على ملف `start-email-service.ps1`
- اختر "Run with PowerShell"

## إعدادات الخدمة

### الجدولة الحالية
- تعمل الخدمة يومياً في الساعة 9:00 صباحاً (توقيت الرياض)
- لتغيير التوقيت، عدل السطر التالي في `automation-service.js`:
```javascript
cron.schedule('0 9 * * *', () => {
```

### أمثلة على الجدولة
- كل دقيقة: `'* * * * *'`
- كل ساعة: `'0 * * * *'`
- كل يوم في الساعة 8 صباحاً: `'0 8 * * *'`
- كل يوم اثنين في الساعة 9 صباحاً: `'0 9 * * 1'`

## استكشاف الأخطاء

### إذا لم يتم إرسال الإيميل:
1. تأكد من صحة إعدادات `.env`
2. تأكد من أن Gmail App Password صحيح
3. تحقق من اتصال الإنترنت
4. راجع رسائل الخطأ في الكونسول

### إذا كانت الخدمة لا تعمل تلقائياً:
1. تأكد من أن البرنامج يعمل باستمرار
2. لا تغلق نافذة Command Prompt
3. يمكنك استخدام Windows Task Scheduler لتشغيل الخدمة عند بدء تشغيل النظام

## ملاحظات مهمة
- الخدمة تحتاج للعمل باستمرار لتعمل الجدولة
- إذا أغلقت النافذة، ستتوقف الخدمة
- يتم إرسال إيميل اختبار عند بدء تشغيل الخدمة
- يتم إرسال إيميل فقط إذا وجدت إقامات تنتهي خلال 30 يوم